<!DOCTYPE html>
<html>
  <head>
    <title>Force-Directed Layout</title>
    <script src="keyboard.js"></script>
    <script type="text/javascript" src="./d3.v2.min.js"></script>
    <script src="http://178.79.173.17:8000/client.js"></script>
    <link type="text/css" rel="stylesheet" href="force.css"/>
  </head>
  <body>
    <div id="timeLeft"></div>
    <div id="chart"></div>
    <script>
      app = {};
    </script>
    <script type="text/javascript" src="force.js"></script>
    <script>
      packageme.require("rexster-client").initialize("//178.79.173.17:8000", function(api){
        api.getGraph("neo4jsample", function(err, graph){
          graph.getVertexes(function(err, vertexes){
            graph.getEdges(function(err, edges){
              var view = app.createGraphView(graph, vertexes, edges);
              
              graph.signals.newVertex.bind(function(vertex){
                view.addNewVertex(vertex);
              });

              graph.signals.newEdge.bind(function(edge){
                view.addNewEdge(edge);
              });

              graph.signals.graphCleared.bind(function(){
                console.log("GRAPH CLEAR SIGNAL");
                // TODO find how to clear d3 svg and the force simulation
              });

              app.graph = graph;
            })
          });
        });
      });

    </script>
  </body>
</html>